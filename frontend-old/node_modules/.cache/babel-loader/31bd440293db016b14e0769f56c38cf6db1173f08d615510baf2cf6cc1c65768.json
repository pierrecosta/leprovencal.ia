{"ast":null,"code":"import _objectSpread from\"/mnt/c/code/leprovencal.ia/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// services/api.js\nimport axios from'axios';import{logApiError}from'../utils/logger';import{normalizeArticlePayload,normalizeDictionnairePayload,normalizeArticleOut,normalizeMotOut,normalizeHistoireOut,normalizeCarteOut,normalizeCartePayload,normalizeMenuHistoiresOut}from'./normalizers';// ===== Base URL via .env (CRA) =====\nconst API_BASE=process.env.REACT_APP_API_URL||'http://localhost:8000';// ===== Instance axios par défaut =====\n// On garde une instance \"publiques\" pour compat (GET publiques existantes)\nconst http=axios.create({baseURL:API_BASE,withCredentials:true// <-- enable cookies (SameSite handled by backend cookie)\n});// ===== Instance axios avec auth =====\n// Cette instance attache automatiquement le token s'il est présent\nconst authHttp=axios.create({baseURL:API_BASE,withCredentials:true// <-- send cookies automatically\n});// --- Token management (in-memory) ---\nlet _token=null;export function setToken(token){_token=token;if(token){// keep Authorization header for in-memory access-token usage (optional)\nauthHttp.defaults.headers.common['Authorization']=\"Bearer \".concat(token);try{window.dispatchEvent(new Event('auth:login'));}catch(_unused){}}else{delete authHttp.defaults.headers.common['Authorization'];try{window.dispatchEvent(new CustomEvent('auth:logout',{detail:{reason:'manual'}}));}catch(_unused2){}}}export function getToken(){return _token;}export function clearToken(){setToken(null);}// ==========================\n//   CROSS-CUTTING HELPERS\n// ==========================\nexport function getRetryAfterSeconds(err){var _err$response,_err$response$headers;const raw=err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$headers=_err$response.headers)===null||_err$response$headers===void 0?void 0:_err$response$headers['retry-after'];if(!raw)return null;const n=Number(raw);return Number.isFinite(n)&&n>0?n:null;}function dispatchLogout(){let reason=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'unauthorized';clearToken();// Let the app react if it wants (optional)\ntry{window.dispatchEvent(new CustomEvent('auth:logout',{detail:{reason}}));}catch(_unused3){// ignore\n}// Note: do NOT redirect to /login automatically. The app should remain browsable\n// for anonymous users; authenticated-only actions will fail with 401 and the\n// UI can decide whether to prompt for login or show an error. This keeps\n// read-only browsing available by default.\n}// Normalizers moved to src/services/normalizers.js\n// ==========================\n//        AXIOS INSTANCES\n// ==========================\n// Interceptor pour l'instance auth\nauthHttp.interceptors.request.use(config=>{const token=getToken();if(token){config.headers=_objectSpread(_objectSpread({},config.headers),{},{Authorization:\"Bearer \".concat(token)});}return config;});// Global response handling (auth)\nauthHttp.interceptors.response.use(res=>res,err=>{var _err$response2;const status=err===null||err===void 0?void 0:(_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status;if(status===401)dispatchLogout('token_invalid_or_expired');logApiError(err);return Promise.reject(err);});// Also log public API errors (no logout here)\nhttp.interceptors.response.use(res=>res,err=>{logApiError(err);return Promise.reject(err);});// ==========================\n//        ENDPOINTS\n// ==========================\n// --- Articles (publics) ---\nexport const getArticles=()=>http.get(\"/articles\").then(res=>_objectSpread(_objectSpread({},res),{},{data:Array.isArray(res.data)?res.data.map(normalizeArticleOut):res.data}));// Paged articles (skip/limit). page is 1-based.\nexport const getArticlesPaged=function(){let{page=1,limit=10}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const skip=Math.max(0,(page-1)*limit);return http.get(\"/articles\",{params:{skip,limit}}).then(res=>_objectSpread(_objectSpread({},res),{},{data:Array.isArray(res.data)?res.data.map(normalizeArticleOut):res.data}));};// Create a new article (authenticated)\nexport async function createArticle(payload){const{data}=await authHttp.post(\"/articles\",normalizeArticlePayload(payload),{headers:{'Content-Type':'application/json'}});return normalizeArticleOut(data);}// Delete an article (authenticated)\nexport async function deleteArticle(id){const res=await authHttp.delete(\"/articles/\".concat(id));return res;}// --- Dictionnaire (publics) ---\nexport const getDictionary=params=>http.get(\"/dictionnaire\",{params}).then(res=>_objectSpread(_objectSpread({},res),{},{data:Array.isArray(res.data)?res.data.map(normalizeMotOut):res.data}));export const getThemes=()=>http.get(\"/dictionnaire/themes\");export const getCategories=theme=>http.get(\"/dictionnaire/categories\",{params:{theme}});// --- Histoires & Légendes (publics) ---\nexport const getHistoires=params=>http.get(\"/histoires\",{params});// Keep response shape, but normalize res.data for UI camelCase-only consumption\nexport const getMenuHistoires=()=>http.get(\"/histoires/menu\").then(res=>_objectSpread(_objectSpread({},res),{},{data:normalizeMenuHistoiresOut(res.data)}));export const getHistoireById=id=>http.get(\"/histoires/\".concat(id)).then(res=>_objectSpread(_objectSpread({},res),{},{data:normalizeHistoireOut(res.data)}));export const findHistoire=titre=>http.get(\"/histoires/find\",{params:{titre}}).then(res=>_objectSpread(_objectSpread({},res),{},{data:Array.isArray(res.data)?res.data.map(normalizeHistoireOut):res.data}));export const getHistoiresPaged=_ref=>{let{page,limit}=_ref;return http.get(\"/histoires/paged\",{params:{page,limit}});};// --- Histoires (CRUD) (authenticated) ---\nexport async function createHistoire(payload){const{data}=await authHttp.post(\"/histoires\",payload,{headers:{'Content-Type':'application/json'}});return normalizeHistoireOut(data);}export async function updateHistoire(id,payload){const{data}=await authHttp.put(\"/histoires/\".concat(id),payload,{headers:{'Content-Type':'application/json'}});return normalizeHistoireOut(data);}export async function deleteHistoire(id){const res=await authHttp.delete(\"/histoires/\".concat(id));return res;}// --- Cartes (Géographie) (public + authenticated mutations) ---\nexport const getCartes=params=>http.get(\"/cartes\",{params}).then(res=>_objectSpread(_objectSpread({},res),{},{data:Array.isArray(res.data)?res.data.map(normalizeCarteOut):res.data}));// Paged cartes (convert page -> skip). page is 1-based.\nexport const getCartesPaged=function(){let{page=1,limit=10}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const skip=Math.max(0,(page-1)*limit);return http.get(\"/cartes\",{params:{skip,limit}}).then(res=>_objectSpread(_objectSpread({},res),{},{data:Array.isArray(res.data)?res.data.map(normalizeCarteOut):res.data}));};export async function createCarte(payload){const{data}=await authHttp.post(\"/cartes\",normalizeCartePayload(payload),{headers:{'Content-Type':'application/json'}});return normalizeCarteOut(data);}export async function updateCarte(id,payload){const{data}=await authHttp.put(\"/cartes/\".concat(id),normalizeCartePayload(payload),{headers:{'Content-Type':'application/json'}});return normalizeCarteOut(data);}export async function deleteCarte(id){const res=await authHttp.delete(\"/cartes/\".concat(id));return res;}// ==========================\n//   STORED IMAGES (BINARY)\n// ==========================\nexport function getArticleImageUrl(id,cacheBuster){const qs=cacheBuster?\"?v=\".concat(encodeURIComponent(String(cacheBuster))):'';return\"\".concat(API_BASE,\"/articles/\").concat(id,\"/image\").concat(qs);}export function getCarteImageUrl(id,cacheBuster){const qs=cacheBuster?\"?v=\".concat(encodeURIComponent(String(cacheBuster))):'';return\"\".concat(API_BASE,\"/cartes/\").concat(id,\"/image\").concat(qs);}export async function uploadArticleImage(id,file){const fd=new FormData();fd.append('image',file);const{data}=await authHttp.put(\"/articles/\".concat(id,\"/image\"),fd);return normalizeArticleOut(data);}export async function deleteArticleImage(id){const{data}=await authHttp.delete(\"/articles/\".concat(id,\"/image\"));return normalizeArticleOut(data);}export async function uploadCarteImage(id,file){const fd=new FormData();fd.append('image',file);const{data}=await authHttp.put(\"/cartes/\".concat(id,\"/image\"),fd);return normalizeCarteOut(data);}export async function deleteCarteImage(id){const{data}=await authHttp.delete(\"/cartes/\".concat(id,\"/image\"));return normalizeCarteOut(data);}// --- Dictionnaire: update d'un mot (ligne du tableau)\nexport async function updateMot(id,payload){const{data}=await authHttp.put(\"/dictionnaire/\".concat(id),normalizeDictionnairePayload(payload),{headers:{'Content-Type':'application/json'}});return normalizeMotOut(data);}// --- Articles: update d'une carte/article\nexport async function updateArticle(id,payload){const{data}=await authHttp.put(\"/articles/\".concat(id),normalizeArticlePayload(payload),{headers:{'Content-Type':'application/json'}});return normalizeArticleOut(data);}// ==========================\n//       AUTH SERVICES\n// ==========================\nexport async function login(_ref2){let{username,password}=_ref2;const params=new URLSearchParams();params.append('username',username);params.append('password',password);const{data}=await http.post(\"/auth/login\",params,{headers:{'Content-Type':'application/x-www-form-urlencoded'}});// Two possible server behaviors:\n// - Return { access_token } (Bearer token) -> frontend stores it via setToken\n// - Or set a HttpOnly cookie and return a simple success payload -> emit login event\nif(data!==null&&data!==void 0&&data.access_token){setToken(data.access_token);}else{try{window.dispatchEvent(new Event('auth:login'));}catch(_unused4){// ignore\n}}return data;}export async function register(_ref3){let{username,password}=_ref3;const{data}=await http.post(\"/auth/register\",{username,password},{headers:{'Content-Type':'application/json'}});return data;}/**\r\n * Récupère l'utilisateur courant (protégé)\r\n * - Nécessite Authorization: Bearer <token>\r\n * - Retour: { username }\r\n */export async function getMe(){const{data}=await authHttp.get(\"/auth/me\");return data;}// (Optionnel) helper logout\nexport function logout(){// Try to notify server (if an endpoint exists) to clear HttpOnly cookie, then dispatch logout locally.\n(async()=>{try{await http.post('/auth/logout');}catch(_unused5){// ignore errors (endpoint may not exist)\n}finally{dispatchLogout('manual');}})();}// ==========================\n//    EXPORTS UTILES PAR DÉFAUT\n// ==========================\nexport const api=http;export const apiAuth=authHttp;// --- Error handling ---\nexport function getApiErrorMessage(err){var _err$response3,_err$response4,_err$response4$header,_err$response5,_err$response5$data,_err$response6,_err$response6$data;const status=err===null||err===void 0?void 0:(_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status;const retryAfter=err===null||err===void 0?void 0:(_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$header=_err$response4.headers)===null||_err$response4$header===void 0?void 0:_err$response4$header['retry-after'];const detail=err===null||err===void 0?void 0:(_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.detail;if(detail&&typeof detail==='object'){if(typeof detail.message==='string'&&detail.message.trim()!=='')return detail.message;if(typeof detail.code==='string'&&detail.code.trim()!=='')return detail.code;try{return JSON.stringify(detail);}catch(_unused6){return'Erreur API';}}if(typeof detail==='string')return detail;const msg=(err===null||err===void 0?void 0:(_err$response6=err.response)===null||_err$response6===void 0?void 0:(_err$response6$data=_err$response6.data)===null||_err$response6$data===void 0?void 0:_err$response6$data.message)||(err===null||err===void 0?void 0:err.message);const base=typeof msg==='string'?msg:'Erreur API';if(status===429&&retryAfter)return\"\".concat(base,\" (Retry-After: \").concat(retryAfter,\"s)\");return base;}// Retourne le champ ciblé par l'erreur si fourni par l'API (ex: { detail: { field: 'titre' } })\nexport function getApiErrorField(err){var _err$response$data$de,_err$response7,_err$response7$data,_err$response7$data$d;return(_err$response$data$de=err===null||err===void 0?void 0:(_err$response7=err.response)===null||_err$response7===void 0?void 0:(_err$response7$data=_err$response7.data)===null||_err$response7$data===void 0?void 0:(_err$response7$data$d=_err$response7$data.detail)===null||_err$response7$data$d===void 0?void 0:_err$response7$data$d.field)!==null&&_err$response$data$de!==void 0?_err$response$data$de:null;}","map":{"version":3,"names":["axios","logApiError","normalizeArticlePayload","normalizeDictionnairePayload","normalizeArticleOut","normalizeMotOut","normalizeHistoireOut","normalizeCarteOut","normalizeCartePayload","normalizeMenuHistoiresOut","API_BASE","process","env","REACT_APP_API_URL","http","create","baseURL","withCredentials","authHttp","_token","setToken","token","defaults","headers","common","concat","window","dispatchEvent","Event","_unused","CustomEvent","detail","reason","_unused2","getToken","clearToken","getRetryAfterSeconds","err","_err$response","_err$response$headers","raw","response","n","Number","isFinite","dispatchLogout","arguments","length","undefined","_unused3","interceptors","request","use","config","_objectSpread","Authorization","res","_err$response2","status","Promise","reject","getArticles","get","then","data","Array","isArray","map","getArticlesPaged","page","limit","skip","Math","max","params","createArticle","payload","post","deleteArticle","id","delete","getDictionary","getThemes","getCategories","theme","getHistoires","getMenuHistoires","getHistoireById","findHistoire","titre","getHistoiresPaged","_ref","createHistoire","updateHistoire","put","deleteHistoire","getCartes","getCartesPaged","createCarte","updateCarte","deleteCarte","getArticleImageUrl","cacheBuster","qs","encodeURIComponent","String","getCarteImageUrl","uploadArticleImage","file","fd","FormData","append","deleteArticleImage","uploadCarteImage","deleteCarteImage","updateMot","updateArticle","login","_ref2","username","password","URLSearchParams","access_token","_unused4","register","_ref3","getMe","logout","_unused5","api","apiAuth","getApiErrorMessage","_err$response3","_err$response4","_err$response4$header","_err$response5","_err$response5$data","_err$response6","_err$response6$data","retryAfter","message","trim","code","JSON","stringify","_unused6","msg","base","getApiErrorField","_err$response$data$de","_err$response7","_err$response7$data","_err$response7$data$d","field"],"sources":["/mnt/c/code/leprovencal.ia/frontend/src/services/api.js"],"sourcesContent":["// services/api.js\r\nimport axios from 'axios';\r\nimport { logApiError } from '../utils/logger';\r\nimport {\r\n  normalizeArticlePayload,\r\n  normalizeDictionnairePayload,\r\n  normalizeArticleOut,\r\n  normalizeMotOut,\r\n  normalizeHistoireOut,\r\n  normalizeCarteOut,\r\n  normalizeCartePayload,\r\n  normalizeMenuHistoiresOut,\r\n} from './normalizers';\r\n\r\n// ===== Base URL via .env (CRA) =====\r\nconst API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:8000';\r\n\r\n// ===== Instance axios par défaut =====\r\n// On garde une instance \"publiques\" pour compat (GET publiques existantes)\r\nconst http = axios.create({\r\n  baseURL: API_BASE,\r\n  withCredentials: true, // <-- enable cookies (SameSite handled by backend cookie)\r\n});\r\n\r\n// ===== Instance axios avec auth =====\r\n// Cette instance attache automatiquement le token s'il est présent\r\nconst authHttp = axios.create({\r\n  baseURL: API_BASE,\r\n  withCredentials: true, // <-- send cookies automatically\r\n});\r\n\r\n// --- Token management (in-memory) ---\r\nlet _token = null;\r\n\r\nexport function setToken(token) {\r\n  _token = token;\r\n  if (token) {\r\n    // keep Authorization header for in-memory access-token usage (optional)\r\n    authHttp.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n    try { window.dispatchEvent(new Event('auth:login')); } catch {}\r\n  } else {\r\n    delete authHttp.defaults.headers.common['Authorization'];\r\n    try { window.dispatchEvent(new CustomEvent('auth:logout', { detail: { reason: 'manual' } })); } catch {}\r\n  }\r\n}\r\n\r\nexport function getToken() {\r\n  return _token;\r\n}\r\n\r\nexport function clearToken() {\r\n  setToken(null);\r\n}\r\n\r\n// ==========================\r\n//   CROSS-CUTTING HELPERS\r\n// ==========================\r\nexport function getRetryAfterSeconds(err) {\r\n  const raw = err?.response?.headers?.['retry-after'];\r\n  if (!raw) return null;\r\n  const n = Number(raw);\r\n  return Number.isFinite(n) && n > 0 ? n : null;\r\n}\r\n\r\nfunction dispatchLogout(reason = 'unauthorized') {\r\n  clearToken();\r\n\r\n  // Let the app react if it wants (optional)\r\n  try {\r\n    window.dispatchEvent(new CustomEvent('auth:logout', { detail: { reason } }));\r\n  } catch {\r\n    // ignore\r\n  }\r\n\r\n  // Note: do NOT redirect to /login automatically. The app should remain browsable\r\n  // for anonymous users; authenticated-only actions will fail with 401 and the\r\n  // UI can decide whether to prompt for login or show an error. This keeps\r\n  // read-only browsing available by default.\r\n}\r\n\r\n// Normalizers moved to src/services/normalizers.js\r\n\r\n// ==========================\r\n//        AXIOS INSTANCES\r\n// ==========================\r\n\r\n// Interceptor pour l'instance auth\r\nauthHttp.interceptors.request.use((config) => {\r\n  const token = getToken();\r\n  if (token) {\r\n    config.headers = {\r\n      ...config.headers,\r\n      Authorization: `Bearer ${token}`,\r\n    };\r\n  }\r\n  return config;\r\n});\r\n\r\n// Global response handling (auth)\r\nauthHttp.interceptors.response.use(\r\n  (res) => res,\r\n  (err) => {\r\n    const status = err?.response?.status;\r\n    if (status === 401) dispatchLogout('token_invalid_or_expired');\r\n    logApiError(err);\r\n    return Promise.reject(err);\r\n  }\r\n);\r\n\r\n// Also log public API errors (no logout here)\r\nhttp.interceptors.response.use(\r\n  (res) => res,\r\n  (err) => {\r\n    logApiError(err);\r\n    return Promise.reject(err);\r\n  }\r\n);\r\n\r\n// ==========================\r\n//        ENDPOINTS\r\n// ==========================\r\n\r\n// --- Articles (publics) ---\r\nexport const getArticles = () =>\r\n  http.get(`/articles`).then((res) => ({\r\n    ...res,\r\n    data: Array.isArray(res.data) ? res.data.map(normalizeArticleOut) : res.data,\r\n  }));\r\n\r\n// Paged articles (skip/limit). page is 1-based.\r\nexport const getArticlesPaged = ({ page = 1, limit = 10 } = {}) => {\r\n  const skip = Math.max(0, (page - 1) * limit);\r\n  return http.get(`/articles`, { params: { skip, limit } }).then((res) => ({\r\n    ...res,\r\n    data: Array.isArray(res.data) ? res.data.map(normalizeArticleOut) : res.data,\r\n  }));\r\n};\r\n\r\n// Create a new article (authenticated)\r\nexport async function createArticle(payload) {\r\n  const { data } = await authHttp.post(`/articles`, normalizeArticlePayload(payload), {\r\n    headers: { 'Content-Type': 'application/json' },\r\n  });\r\n  return normalizeArticleOut(data);\r\n}\r\n\r\n// Delete an article (authenticated)\r\nexport async function deleteArticle(id) {\r\n  const res = await authHttp.delete(`/articles/${id}`);\r\n  return res;\r\n}\r\n\r\n// --- Dictionnaire (publics) ---\r\nexport const getDictionary = (params) =>\r\n  http.get(`/dictionnaire`, { params }).then((res) => ({\r\n    ...res,\r\n    data: Array.isArray(res.data) ? res.data.map(normalizeMotOut) : res.data,\r\n  }));\r\n\r\nexport const getThemes = () => http.get(`/dictionnaire/themes`);\r\nexport const getCategories = (theme) => http.get(`/dictionnaire/categories`, { params: { theme } });\r\n\r\n// --- Histoires & Légendes (publics) ---\r\nexport const getHistoires = (params) => http.get(`/histoires`, { params });\r\n\r\n// Keep response shape, but normalize res.data for UI camelCase-only consumption\r\nexport const getMenuHistoires = () =>\r\n  http.get(`/histoires/menu`).then((res) => ({ ...res, data: normalizeMenuHistoiresOut(res.data) }));\r\n\r\nexport const getHistoireById = (id) =>\r\n  http.get(`/histoires/${id}`).then((res) => ({ ...res, data: normalizeHistoireOut(res.data) }));\r\n\r\nexport const findHistoire = (titre) =>\r\n  http.get(`/histoires/find`, { params: { titre } }).then((res) => ({\r\n    ...res,\r\n    data: Array.isArray(res.data) ? res.data.map(normalizeHistoireOut) : res.data,\r\n  }));\r\n\r\nexport const getHistoiresPaged = ({ page, limit }) => http.get(`/histoires/paged`, { params: { page, limit } });\r\n\r\n// --- Histoires (CRUD) (authenticated) ---\r\nexport async function createHistoire(payload) {\r\n  const { data } = await authHttp.post(`/histoires`, payload, {\r\n    headers: { 'Content-Type': 'application/json' },\r\n  });\r\n  return normalizeHistoireOut(data);\r\n}\r\n\r\nexport async function updateHistoire(id, payload) {\r\n  const { data } = await authHttp.put(`/histoires/${id}`, payload, {\r\n    headers: { 'Content-Type': 'application/json' },\r\n  });\r\n  return normalizeHistoireOut(data);\r\n}\r\n\r\nexport async function deleteHistoire(id) {\r\n  const res = await authHttp.delete(`/histoires/${id}`);\r\n  return res;\r\n}\r\n\r\n// --- Cartes (Géographie) (public + authenticated mutations) ---\r\nexport const getCartes = (params) =>\r\n  http.get(`/cartes`, { params }).then((res) => ({\r\n    ...res,\r\n    data: Array.isArray(res.data) ? res.data.map(normalizeCarteOut) : res.data,\r\n  }));\r\n\r\n// Paged cartes (convert page -> skip). page is 1-based.\r\nexport const getCartesPaged = ({ page = 1, limit = 10 } = {}) => {\r\n  const skip = Math.max(0, (page - 1) * limit);\r\n  return http.get(`/cartes`, { params: { skip, limit } }).then((res) => ({\r\n    ...res,\r\n    data: Array.isArray(res.data) ? res.data.map(normalizeCarteOut) : res.data,\r\n  }));\r\n};\r\n\r\nexport async function createCarte(payload) {\r\n  const { data } = await authHttp.post(`/cartes`, normalizeCartePayload(payload), {\r\n    headers: { 'Content-Type': 'application/json' },\r\n  });\r\n  return normalizeCarteOut(data);\r\n}\r\n\r\nexport async function updateCarte(id, payload) {\r\n  const { data } = await authHttp.put(`/cartes/${id}`, normalizeCartePayload(payload), {\r\n    headers: { 'Content-Type': 'application/json' },\r\n  });\r\n  return normalizeCarteOut(data);\r\n}\r\n\r\nexport async function deleteCarte(id) {\r\n  const res = await authHttp.delete(`/cartes/${id}`);\r\n  return res;\r\n}\r\n\r\n// ==========================\r\n//   STORED IMAGES (BINARY)\r\n// ==========================\r\n\r\nexport function getArticleImageUrl(id, cacheBuster) {\r\n  const qs = cacheBuster ? `?v=${encodeURIComponent(String(cacheBuster))}` : '';\r\n  return `${API_BASE}/articles/${id}/image${qs}`;\r\n}\r\n\r\nexport function getCarteImageUrl(id, cacheBuster) {\r\n  const qs = cacheBuster ? `?v=${encodeURIComponent(String(cacheBuster))}` : '';\r\n  return `${API_BASE}/cartes/${id}/image${qs}`;\r\n}\r\n\r\nexport async function uploadArticleImage(id, file) {\r\n  const fd = new FormData();\r\n  fd.append('image', file);\r\n  const { data } = await authHttp.put(`/articles/${id}/image`, fd);\r\n  return normalizeArticleOut(data);\r\n}\r\n\r\nexport async function deleteArticleImage(id) {\r\n  const { data } = await authHttp.delete(`/articles/${id}/image`);\r\n  return normalizeArticleOut(data);\r\n}\r\n\r\nexport async function uploadCarteImage(id, file) {\r\n  const fd = new FormData();\r\n  fd.append('image', file);\r\n  const { data } = await authHttp.put(`/cartes/${id}/image`, fd);\r\n  return normalizeCarteOut(data);\r\n}\r\n\r\nexport async function deleteCarteImage(id) {\r\n  const { data } = await authHttp.delete(`/cartes/${id}/image`);\r\n  return normalizeCarteOut(data);\r\n}\r\n\r\n// --- Dictionnaire: update d'un mot (ligne du tableau)\r\nexport async function updateMot(id, payload) {\r\n  const { data } = await authHttp.put(\r\n    `/dictionnaire/${id}`,\r\n    normalizeDictionnairePayload(payload),\r\n    { headers: { 'Content-Type': 'application/json' } }\r\n  );\r\n  return normalizeMotOut(data);\r\n}\r\n\r\n// --- Articles: update d'une carte/article\r\nexport async function updateArticle(id, payload) {\r\n  const { data } = await authHttp.put(\r\n    `/articles/${id}`,\r\n    normalizeArticlePayload(payload),\r\n    { headers: { 'Content-Type': 'application/json' } }\r\n  );\r\n  return normalizeArticleOut(data);\r\n}\r\n\r\n// ==========================\r\n//       AUTH SERVICES\r\n// ==========================\r\n\r\nexport async function login({ username, password }) {\r\n  const params = new URLSearchParams();\r\n  params.append('username', username);\r\n  params.append('password', password);\r\n\r\n  const { data } = await http.post(`/auth/login`, params, {\r\n    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\r\n  });\r\n\r\n  // Two possible server behaviors:\r\n  // - Return { access_token } (Bearer token) -> frontend stores it via setToken\r\n  // - Or set a HttpOnly cookie and return a simple success payload -> emit login event\r\n  if (data?.access_token) {\r\n    setToken(data.access_token);\r\n  } else {\r\n    try {\r\n      window.dispatchEvent(new Event('auth:login'));\r\n    } catch {\r\n      // ignore\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nexport async function register({ username, password }) {\r\n  const { data } = await http.post(\r\n    `/auth/register`,\r\n    { username, password },\r\n    { headers: { 'Content-Type': 'application/json' } }\r\n  );\r\n  return data;\r\n}\r\n\r\n/**\r\n * Récupère l'utilisateur courant (protégé)\r\n * - Nécessite Authorization: Bearer <token>\r\n * - Retour: { username }\r\n */\r\nexport async function getMe() {\r\n  const { data } = await authHttp.get(`/auth/me`);\r\n  return data;\r\n}\r\n\r\n// (Optionnel) helper logout\r\nexport function logout() {\r\n  // Try to notify server (if an endpoint exists) to clear HttpOnly cookie, then dispatch logout locally.\r\n  (async () => {\r\n    try {\r\n      await http.post('/auth/logout');\r\n    } catch {\r\n      // ignore errors (endpoint may not exist)\r\n    } finally {\r\n      dispatchLogout('manual');\r\n    }\r\n  })();\r\n}\r\n\r\n// ==========================\r\n//    EXPORTS UTILES PAR DÉFAUT\r\n// ==========================\r\nexport const api = http;\r\nexport const apiAuth = authHttp;\r\n\r\n// --- Error handling ---\r\nexport function getApiErrorMessage(err) {\r\n  const status = err?.response?.status;\r\n  const retryAfter = err?.response?.headers?.['retry-after'];\r\n\r\n  const detail = err?.response?.data?.detail;\r\n\r\n  if (detail && typeof detail === 'object') {\r\n    if (typeof detail.message === 'string' && detail.message.trim() !== '') return detail.message;\r\n    if (typeof detail.code === 'string' && detail.code.trim() !== '') return detail.code;\r\n    try {\r\n      return JSON.stringify(detail);\r\n    } catch {\r\n      return 'Erreur API';\r\n    }\r\n  }\r\n\r\n  if (typeof detail === 'string') return detail;\r\n\r\n  const msg = err?.response?.data?.message || err?.message;\r\n  const base = typeof msg === 'string' ? msg : 'Erreur API';\r\n\r\n  if (status === 429 && retryAfter) return `${base} (Retry-After: ${retryAfter}s)`;\r\n  return base;\r\n}\r\n\r\n// Retourne le champ ciblé par l'erreur si fourni par l'API (ex: { detail: { field: 'titre' } })\r\nexport function getApiErrorField(err) {\r\n  return err?.response?.data?.detail?.field ?? null;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}